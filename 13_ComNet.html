<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Prof. Dr. Juanjo Manjarín" />


<title>Introduction to Communities</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Social Media Analytics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Social Media Analytics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Unit I</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="01_NetworkData.html">Networks and their Data Sets</a>
        </li>
        <li>
          <a href="02_MathNet.html">Mathematical Description of Networks</a>
        </li>
        <li>
          <a href="03_Measures.html">Measures in Networks</a>
        </li>
        <li>
          <a href="04_RBasics.html">Basics of `igraph`</a>
        </li>
        <li>
          <a href="05_Ex_Unit_I_Solutions.html">Exercises With Solutions</a>
        </li>
      </ul>
    </li>
    <li class="divider"></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Unit II</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="06_RNets.html">Random Networks</a>
        </li>
        <li>
          <a href="07_SFNets.html">Scale-Free Networks</a>
        </li>
        <li>
          <a href="08_PANets.html">Preferential Attachment Networks</a>
        </li>
        <li>
          <a href="09_NetModels.html">Modelling Networks in R</a>
        </li>
        <li>
          <a href="10_Ex_Unit_II_Solutions.html">Exercises With Solutions</a>
        </li>
      </ul>
    </li>
    <li class="divider"></li>
    <li>
      <a href="Midterm_Exam_-_Solutions.html">Midterm Exam</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Unit III</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="11_DegCorrel.html">Degree Correlation</a>
        </li>
        <li>
          <a href="12_Assortativity.html">Assortativity</a>
        </li>
        <li>
          <a href="13_ComNet.html">Introduction to Communities</a>
        </li>
        <li>
          <a href="14_MAAlg.html">Machine Learning Algorithms in R</a>
        </li>
        <li>
          <a href="Ex_Unit_III.html">Exercises</a>
        </li>
      </ul>
    </li>
    <li class="divider"></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Unit IV</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="SprePhen.html">Spreading Phenomena</a>
        </li>
        <li>
          <a href="CEMod.html">Classical Epidemics Models</a>
        </li>
        <li>
          <a href="NetEpi.html">Network Epidemics</a>
        </li>
        <li>
          <a href="NetDif.html">Network Diffusion</a>
        </li>
        <li>
          <a href="Ex_Unit_IV.html">Exercises</a>
        </li>
      </ul>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="IntroR.html">R Course</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to Communities</h1>
<h4 class="author">Prof. Dr. Juanjo Manjarín</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#definition-of-community"><span class="toc-section-number">1</span> Definition of Community</a><ul>
<li><a href="#cliques-and-cores"><span class="toc-section-number">1.1</span> Cliques and Cores</a></li>
<li><a href="#strong-and-weak-communities"><span class="toc-section-number">1.2</span> Strong and Weak Communities</a></li>
</ul></li>
<li><a href="#modularity-maximization"><span class="toc-section-number">2</span> Modularity Maximization</a><ul>
<li><a href="#community-detection"><span class="toc-section-number">2.1</span> Community Detection</a></li>
</ul></li>
<li><a href="#modularity-limits"><span class="toc-section-number">3</span> Modularity Limits</a></li>
</ul>
</div>

<hr />
<p>In this chapter we are going to use the <code>Bali</code> dataset from the <code>UserNetR</code> package, which as mentioned in its description, “shows the interactions among the Jemaah Islamiyah terrorist group that carried the bombings in Bali in 2002”, whose basic plot is</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">plot</span>(Bali_net,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">     <span class="dt">layout =</span> layout.fruchterman.reingold)</a></code></pre></div>
<p><img src="13_ComNet_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>note that the network has some interesting vertex attributes that will be used later, as the name and the role of each terrorist.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">list.vertex.attributes</span>(Bali_net)</a></code></pre></div>
<pre><code>## [1] &quot;na&quot;           &quot;role&quot;         &quot;vertex.names&quot;</code></pre>
<p><a href="#">Back to top</a></p>
<!-- definition and main hypoth -->
<div id="definition-of-community" class="section level1">
<h1><span class="header-section-number">1</span> Definition of Community</h1>
<p>In this chapter we deal with the groups that exist in any complex system. Due to the own properties of a network, there will be cases in which there are structures in it that may somehow force these groups to exist, for example, departments in a university, areas in a firm, class groups in a univerity and so on. However, even in these cases there may exist som underlying structures we are unaware of and finding them is useful to determine the organization of the network.</p>
<p>The determination of these groups allow us to break down the network into smaller systems of manageable size which may be later analysed individually.</p>
<p>In network science a community is a <strong>group of nodes that have a higher likelihood of connecting each other than with any other member of other community</strong>. In this definition we may usually consider the number of nodes as an indicative of the community. However, it is quite open and gives a first hint of the problems we will find in detecting the communities: what is <em>many</em> or <em>few</em> nodes? What is a <em>higher</em> likelihood exactly meaning?</p>
<p>As Newman puts it, to turn community detection into a quantitative problem we have to assign numbers to these concepts. Then let’s begin with some <strong>basic assumptions</strong>:</p>
<ul>
<li><strong>Fundamental hypothesis</strong>: A network’s community structure is encoded in its wiring diagram</li>
<li><strong>Connectedness and Density hypothesis</strong>: A community is a locally dense connected subgraph in a network.</li>
</ul>
<p><a href="#">Back to top</a></p>
<!-- cliques and cores -->
<div id="cliques-and-cores" class="section level2">
<h2><span class="header-section-number">1.1</span> Cliques and Cores</h2>
<p>These two hypotheses narrow the definition of community and still many different possible definitions still fit. For example, in sociology it is common to use some different approache to a cohesive group. Here we give only two examples</p>
<ul>
<li><strong>n-cliques</strong>: based on the reachability of the nodes, we require that nodes are connected by a geodesic of at most length <span class="math inline">\(n\)</span>. Then an <em>n</em>-clique is a maximal subgraph in which the largest geodesic connecting any two of its nodes is no longer than <span class="math inline">\(n\)</span>.</li>
</ul>
<p>To find the cliques in R we may use <code>cliques</code>. However, if we have a large network, this may not be very interesting. It may be better to use <code>large.cliques</code> and <code>maximal.cliques</code>, then</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">largest.cliques</span>(Bali_net)</a></code></pre></div>
<pre><code>## [[1]]
## + 9/17 vertices, from 9d26c04:
## [1]  4  6  1  3  5  8  9 15 17</code></pre>
<p>it returns that nodes <span class="math inline">\((1, 3, 4, 6, 8, 15, 17)\)</span> form the largest clique, and that</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">maximal.cliques</span>(Bali_net, <span class="dt">min =</span> <span class="dv">6</span>)</a></code></pre></div>
<pre><code>## [[1]]
## + 6/17 vertices, from 9d26c04:
## [1] 12  4 14 13 11 10
## 
## [[2]]
## + 7/17 vertices, from 9d26c04:
## [1] 16  3 17 15  9  8  5
## 
## [[3]]
## + 9/17 vertices, from 9d26c04:
## [1]  1  3 17 15  9  8  6  5  4</code></pre>
<p>we have, for example, three cliques with at least 6 nodes.</p>
<ul>
<li><strong>k-cores</strong>: based on the density of edges, we define a <span class="math inline">\(k\)</span>-core as a subgraph in which each node is adjacent to at least a minimum of <span class="math inline">\(k\)</span> other nodes</li>
</ul>
<p>To find this in R let’s create a vertez label for the <code>coreness</code> of the node, then let’s use a discrete palette to color the nodes</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">coreness &lt;-<span class="st"> </span><span class="kw">graph.coreness</span>(Bali_net)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">V</span>(Bali_net)<span class="op">$</span>coreness &lt;-<span class="st"> </span>coreness</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="kw">V</span>(Bali_net)<span class="op">$</span>color &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="kw">max</span>(coreness), <span class="st">&quot;Set3&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in vattrs[[name]][index] &lt;- value: number of items to replace is
## not a multiple of replacement length</code></pre>
<p>We can now define the <span class="math inline">\(k\)</span>-cores using the <code>induced.subgraph()</code> function. The graph below shows how we can remove lower k-core nodes from the graph</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">plot_kcore &lt;-<span class="st"> </span><span class="cf">function</span>(x, k){</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  core &lt;-<span class="st"> </span><span class="kw">graph.coreness</span>(x)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="kw">plot</span>(<span class="kw">induced.subgraph</span>(x,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                        <span class="dt">vids =</span> <span class="kw">which</span>(core <span class="op">&gt;</span><span class="st"> </span>k)),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">       <span class="dt">layout =</span> layout.fruchterman.reingold,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">       <span class="dt">vertex.label =</span> core,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">       <span class="dt">vertex.size =</span> core<span class="op">*</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">       <span class="dt">vertex.color =</span> core <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">  <span class="kw">title</span>(<span class="kw">paste0</span>(<span class="st">&quot;k-cores: &quot;</span>, k, <span class="st">&quot;-&quot;</span>, <span class="kw">max</span>(core)))</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">cores &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="kw">sapply</span>(cores, <span class="cf">function</span>(x) <span class="kw">plot_kcore</span>(Bali_net, x))</a></code></pre></div>
<p><img src="13_ComNet_files/figure-html/unnamed-chunk-7-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL</code></pre>
<p><a href="#">Back to top</a></p>
<!-- strong and weak -->
</div>
<div id="strong-and-weak-communities" class="section level2">
<h2><span class="header-section-number">1.2</span> Strong and Weak Communities</h2>
<p>The definition above may be a bit too restrictive, then let’s consider a subgraph <span class="math inline">\(C\)</span> made out of <span class="math inline">\(N_c\)</span> nodes. We denote as <span class="math inline">\(k_i^{int}\)</span> the <strong>internal degree</strong>, the number of links of node <span class="math inline">\(i\)</span> with the other nodes in <span class="math inline">\(C\)</span>, and as <span class="math inline">\(k_i^{ext}\)</span> the <strong>external degree</strong> as the number of links of node <span class="math inline">\(i\)</span> with the rest of the network.</p>
<p>Then we define a <strong>Strong Community</strong> as one in which any node in it has more connections with other nodes in the network than with any other node out of it</p>
<p><span class="math display">\[\begin{equation}
k_i^{int}(C) &gt; k_i^{ext}(C)
\end{equation}\]</span></p>
<p>We define a <strong>Weak Community</strong> looking at the overall degree instead of the individual degrees, then this occurs when the total internal degree of the subgraph exceeds its total external degree</p>
<p><span class="math display">\[\begin{equation}
\sum_i k_i^{int}(C) &gt; \sum_i k_i^{ext}(C)
\end{equation}\]</span></p>
<p><a href="#">Back to top</a></p>
<!-- modularity max-->
</div>
</div>
<div id="modularity-maximization" class="section level1">
<h1><span class="header-section-number">2</span> Modularity Maximization</h1>
<p>In this chapter we will only focus in the algorithms of community detection based on the modularity function we defined in the previous chapter</p>
<p><span class="math display">\[\begin{equation}
Q = \frac{1}{2L}\sum_{i,j}\left( A_{ij} - \frac{k_ik_j}{2L}\right)\delta_{g_ig_j}
\end{equation}\]</span></p>
<p>where now, the Kronecker delta runs of the community indices. The idea is that by running along all different possible communities to which any node in the network may belong to, we can find the configuration such that modularity is maximized.</p>
<p>However, even considering that we have only two communities, in a network of order <span class="math inline">\(N\)</span>, there are <span class="math inline">\(2^N\)</span> ways to divide the nodes which implies that even for <span class="math inline">\(100\)</span> nodes the combinations are <span class="math inline">\(\sim 10^{30}\)</span>.</p>
<p>The problem we face here is that this brute-force attack, as Brandes et al. proved is an NP-complete hard problem. Although this relies on the unproved Millenial Unsolved Problem ($1M as reward for any who solves it)on whether NP problems are P problems, this implies that a solution cannot be verified in polynomial time.</p>
<p>What can we do then? First, details apart, we are interested in cases in which the community structure is clear. If it is difficult to dectect or obscure, in many cases it will not be telling us too much (be careful with this argument since it seems that we may give importance only to the values that we can easily measure!). In this sense, there is a number of different <em>heuristic algorithms</em> that give us an approximate, but acceptable solution.</p>
<p>Now, these methods, which lie in the framework of <em>discrete optimization problems</em>, may return a high modularity value and yet a far from optimal division (search for <em>replica symmetry breaking</em> if you are interested on this point).</p>
<!-- comms detection -->
<div id="community-detection" class="section level2">
<h2><span class="header-section-number">2.1</span> Community Detection</h2>
<p>In <code>igraph</code> we have a number of different algorithms that can be used to find communities, however, be careful since each of them can be applied under some conditions. In alphabetical order, we can see them in the following table</p>
<p><br></p>
<table>
<thead>
<tr class="header">
<th align="center">Name</th>
<th align="center">Function</th>
<th align="center">Directed</th>
<th align="center">Weighted</th>
<th align="center">Components</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Edge Betweeness</td>
<td align="center"><code>cluster_edge_bewteeness()</code></td>
<td align="center">T</td>
<td align="center">T</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Fast-Greedy</td>
<td align="center"><code>cluster_fast_greedy()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">InfoMAP</td>
<td align="center"><code>cluster_infomap()</code></td>
<td align="center">T</td>
<td align="center">T</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Label Propagation</td>
<td align="center"><code>cluster_label_prop()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">F</td>
</tr>
<tr class="odd">
<td align="center">Leading Eigenvector</td>
<td align="center"><code>cluster_leading_eigen()</code></td>
<td align="center">F</td>
<td align="center">F</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Louvain</td>
<td align="center"><code>cluster_louvain()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">Optimal</td>
<td align="center"><code>cluster_optimal()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Spinglass</td>
<td align="center"><code>cluster_spinglass()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">F</td>
</tr>
<tr class="odd">
<td align="center">Walktrap</td>
<td align="center"><code>cluster_walktrap()</code></td>
<td align="center">F</td>
<td align="center">T</td>
<td align="center">F</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>In it we see that only Edge-Bewtweenness and InfoMAP can be used in directed graphs; that only the Leading Eigenvector cannot receive weighted networks and that they perform differently with respect to the number of components.</p>
<p>We are going to use some them for the Bali network and see that each of them produces slightly different results.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">plot_communities &lt;-<span class="st"> </span><span class="cf">function</span>(graph, alg, <span class="dt">title =</span> <span class="st">&quot;&quot;</span>){</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  clt &lt;-<span class="st"> </span><span class="kw">alg</span>(graph)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  mod &lt;-<span class="st"> </span><span class="kw">modularity</span>(graph, <span class="kw">membership</span>(clt))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  graph <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">    </span><span class="kw">ggraph</span>(<span class="dt">layout =</span> <span class="st">&quot;kk&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_edge_link</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_node_point</span>(<span class="dt">size =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb12-10" data-line-number="10">                    <span class="dt">color =</span> <span class="kw">membership</span>(clt) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_node_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> role)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_node_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> vertex.names), </a>
<a class="sourceLine" id="cb12-13" data-line-number="13">                    <span class="dt">repel =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">                    <span class="dt">show.legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">                    <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> title, <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;Modularity: &quot;</span>, <span class="kw">round</span>(mod, <span class="dv">4</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="st">    </span><span class="kw">theme_graph</span>(<span class="dt">border =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;None&quot;</span>,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">          <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">          <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb12-22" data-line-number="22"></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"></a>
<a class="sourceLine" id="cb12-24" data-line-number="24">a &lt;-<span class="st"> </span><span class="kw">plot_communities</span>(Bali_net, cluster_fast_greedy, <span class="st">&quot;Fast Greedy&quot;</span>)</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">b &lt;-<span class="st"> </span><span class="kw">plot_communities</span>(Bali_net, cluster_louvain, <span class="st">&quot;Louvain&quot;</span>)</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">c &lt;-<span class="st"> </span><span class="kw">plot_communities</span>(Bali_net, cluster_walktrap, <span class="st">&quot;Walktrap&quot;</span>)</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">d &lt;-<span class="st"> </span><span class="kw">plot_communities</span>(Bali_net, cluster_edge_betweenness, <span class="st">&quot;Edge Betweenness&quot;</span>)</a>
<a class="sourceLine" id="cb12-28" data-line-number="28"></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="kw">plot_grid</span>(a,b,c,d, <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="13_ComNet_files/figure-html/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;" /></p>
<!-- modularity limits -->
</div>
</div>
<div id="modularity-limits" class="section level1">
<h1><span class="header-section-number">3</span> Modularity Limits</h1>
<p>Given the importance of modularity in networks, we should be aware of some limitations it has:</p>
<ul>
<li><strong>Resolution Limit</strong>: If we consider two subgraphs in the network such that their total degrees satisfy</li>
</ul>
<p><span class="math display">\[\begin{equation}
 k\leq \sqrt{2L}
 \end{equation}\]</span></p>
<p>the modularity will always increase if these communities are grouped into one single community even if we knew that they are different. This gives us a resolution limit, since modularity maximization cannot detect communities whose degree satisfies the previous relation.</p>
<ul>
<li><strong>Modulariy Maxima</strong>: As we have mentioned before, finding the exact value at which modularity is maximized is a really hard problem and there may be many different configurations which return a similar yet different value of modularity. Even more, sometimes although with high modularity, the configuration obtained may not correspond to the true one.</li>
</ul>
</div>

<footer>
  <div id="rbmvFooter" class="footer">
    <div class="footerContent">
    
    <p>Copyright &copy; 2020 Juanjo Manjarín, IE University. All rights reserved.</p>
    
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
